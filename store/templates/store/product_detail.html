{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'store/add_update_product.css' %}">

<div class="card">
    {% comment %} <a href="{% url 'product_list' %}">&rarr; رجوع</a> {% endcomment %}
<div class="container">
    <form method="post" id="product-form">
        {% csrf_token %}
        <!-- Render the name field -->
         <div class="right-column"> 
            <label class="form-label" for="{{ form.name.id_for_label }}"> المادة : </label>
            <br>
            {{ form.name }}
            {% if form.name.errors %}
                <div class="error">{{ form.name.errors }}</div>
            {% endif %}
            <br>

            <label class="form-label" for="{{ form.price.id_for_label }}">السعر $ : </label>
            <br>
            {{ form.price }}
            {% if form.price.errors %}
                <div class="error">{{ form.price.errors }}</div>
            {% endif %}
            <br>
      
        
        <!-- Render the quantity field -->
      
            <label class="form-label" for="{{ form.quantity.id_for_label }}">الكمية الحالية : </label>
            <br>
            {{ form.quantity }}
            {% if form.quantity.errors %}
                <div class="error">{{ form.quantity.errors }}</div>
            {% endif %}
            <br>
     
        
        <!-- Render the additional_quantity field -->
     
            <label class="form-label" for="{{ form.additional_quantity.id_for_label }}">الكمية الإضافية : </label>
            <br>
            {{ form.additional_quantity }}
            {% if form.additional_quantity.errors %}
                <div class="error">{{ form.additional_quantity.errors }}</div>
            {% endif %}
            <br>
        
        </div>


         <div class="left-column">
       
       

        <!-- Render the classification field -->
     
            <label class="form-label" for="{{ form.classification.id_for_label }}">الصنف : </label>
            <br>
            {{ form.classification }}
                 <a class="add-classification" href={% url 'add_classification' %}>+</a>
            {% if form.classification.errors %}
                <div class="error">{{ form.classification.errors }}</div>
            {% endif %}
            <br>

            <label class="form-label" for="{{form.retail_sale_percent.id_for_label}}">نسبة الربح % (مفرق) : </label><br>
            {{form.retail_sale_percent}}
            <br>
            <label class="form-label" for="{{form.whole_sale_percent.id_for_label}}">نسبة الربح % (جملة) : </label><br>
            {{form.whole_sale_percent}}
            <br>
            <label class="form-label" for="{{ form.description.id_for_label }}">الوصف : </label>
            <br>
            {{ form.description }}
            {% if form.description.errors %}
                <div class="error">{{ form.description.errors }}</div>
            {% endif %}
    
         </div>
     
        <!-- Submit and cancel buttons -->
      
            <button type="submit" class="btn blue">حفظ التغييرات</button>
            <a class="btn gray" style="font-size:small" href="{% url 'product_list' %}">رجوع</a>
            <button type="button" class="btn red" id="delete-btn">حذف المنتج</button>
      
    </form>
    </div>
    </div>
    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            {% comment %} <p>حذف المنتج سيؤدي إلى حذف كل عمليات البيع المتعلقة به !</p> {% endcomment %}
             <p>لن يتم حذف عمليات البيع الخاصة بالمنتج في حال وجودها , هل تريد حذف المنتج ؟</p>
            <div class="modal-actions">
                <button class="btn red">
                    <a href="{% url 'remove_product' product_id %}">حذف</a>
                </button>
                <button type="button" class="btn gray" id="cancel-delete">إلغاء</button>
            </div>
        </div>
    </div>


    <!-- JavaScript to handle the modal -->
    <script>
        // Get the modal and buttons
        const modal = document.getElementById('delete-modal');
        const deleteBtn = document.getElementById('delete-btn');
        const cancelBtn = document.getElementById('cancel-delete');

        // Show the modal when the delete button is clicked
        deleteBtn.addEventListener('click', () => {
            modal.style.display = 'block';
        });

        // Hide the modal when the cancel button is clicked
        cancelBtn.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        // Hide the modal if the user clicks outside of it
        window.addEventListener('click', (event) => {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });
    </script>
{% endblock %}